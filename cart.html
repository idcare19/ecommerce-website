<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FOREVER - Shopping Cart</title>
  <link rel="stylesheet" href="header.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Montserrat', sans-serif; color: #333; }
    a { text-decoration: none; color: inherit; }
    .cart-header { font-size: 32px; font-weight: 700; margin-bottom: 40px; text-transform: uppercase; }
    .table thead th { border-bottom: 2px solid #333; font-weight: 600; font-size: 14px; text-transform: uppercase; color: #333; }
    .cart-item-image { width: 80px; height: 100px; object-fit: cover; margin-right: 15px; }
    .quantity-control { display: flex; align-items: center; }
    .quantity-control button {
      background: #fff; border: 1px solid #ccc; width: 30px; height: 30px;
      display: flex; justify-content: center; align-items: center;
      padding: 0; font-size: 18px; cursor: pointer; transition: background-color 0.2s;
    }
    .quantity-control button:hover { background-color: #f1f1f1; }
    .quantity-control input {
      width: 50px; text-align: center; border: 1px solid #ccc;
      height: 30px; margin: 0 5px; font-size: 14px;
    }
    .remove-btn { background: none; border: none; color: #dc3545; cursor: pointer; font-size: 14px; text-decoration: underline; }
    .cart-totals { background-color: #f8f8f8; padding: 30px; }
    .cart-totals h5 { font-weight: 700; margin-bottom: 20px; }
    .cart-totals .d-flex { justify-content: space-between; margin-bottom: 15px; font-size: 16px; }
    .cart-totals .total-price { font-size: 20px; font-weight: 700; border-top: 1px solid #ccc; padding-top: 15px; }
    .checkout-btn { width: 100%; background-color: #000; color: #fff; padding: 15px; font-weight: 600; border-radius: 0; }
    .checkout-btn:hover { background-color: #333; color: #fff; }
  </style>
</head>

<body>
 <header>
    <nav class="navbar navbar-expand-lg container-fluid py-3">
        <div class="container d-flex justify-content-between align-items-center">
            
            <a class="navbar-brand logo-text" href="#"><img src="im/img01.png" alt=""></a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse justify-content-center" id="navbarNav">
                <ul class="navbar-nav mx-auto nav-links-custom">
                    <li class="nav-item">
                        <a class="nav-link active-link" aria-current="page" href="index.html">HOME</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="collection.html">COLLECTION</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="about.html">ABOUT</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="contact.html">CONTACT</a>
                    </li>
                </ul>
            </div>

            <div class="d-flex align-items-center right-nav-section">
                <a href="admin.html" class="nav-link me-4 admin-portal-link d-none d-md-block"><button class="btn btn-sm btn-outline-dark">Admin Portal</button></a>
<div class="dropdown me-3 search-dropdown-custom">
    <a href="#" class="nav-link search-icon-btn" role="button" data-bs-toggle="dropdown" aria-expanded="false">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-search" viewBox="0 0 16 16"><path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398l3.654 3.653a1 1 0 0 0 1.414-1.414l-3.654-3.653zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/></svg>
    </a>
    <div class="dropdown-menu dropdown-menu-end search-input-container">
        <form class="p-2 d-flex">
            <input type="search" class="form-control" placeholder="Search products..." aria-label="Search">
            <button class="btn btn-dark ms-2" type="submit">Go</button>
        </form>
    </div>
</div>                <a href="#" class="nav-link me-3"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16"><path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zm2-3a2 2 0 1 1-4 0 2 2 0 0 1 4 0zm4 8a.5.5 0 0 0-.5-.5H2.5a.5.5 0 0 0 0 1h11a.5.5 0 0 0 .5-.5z"/><path d="M10.87 13.9a5.5 5.5 0 0 0-9.74 0H.5a.5.5 0 0 0 0 1h15a.5.5 0 0 0 0-1h-4.63z"/></svg></a>
                <div class="cart-icon-container position-relative">
                    <a href="cart.html" class="nav-link"><img src="im/img04.png" width="20" height="20" fill="currentColor" class="bi bi-bag" viewBox="0 0 16 16"><path d="M8 1a2.5 2.5 0 0 1 2.5 2.5V4h-5v-.5A2.5 2.5 0 0 1 8 1z"/><path d="M6.5 4V3.5a1.5 1.5 0 1 1 3 0V4h.5a4.5 4.5 0 0 0 4.5-4.5V1H1V.5A.5.5 0 0 0 .5 0h-1a.5.5 0 0 0 .5.5V1h15V.5a.5.5 0 0 0-.5-.5H1zM1 15a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V5H1v10z"/></svg></a>
                    <span class="badge rounded-pill bg-dark position-absolute top-0 start-100 translate-middle cart-count">0</span>
                </div>
            </div>
        </div>
    </nav>
</header>

  <main class="container py-5">
    <h1 class="cart-header text-center">Your Shopping Cart</h1>
    <div class="row">
      <div class="col-lg-8 mb-4">
        <div class="table-responsive">
          <table class="table align-middle">
            <thead>
              <tr>
                <th style="width: 40%;">Product</th>
                <th style="width: 15%;">Price</th>
                <th style="width: 25%;">Quantity</th>
                <th style="width: 15%;">Subtotal</th>
                <th style="width: 5%;">Remove</th>
              </tr>
            </thead>
            <tbody id="cart-items-body"></tbody>
          </table>
        </div>
        <div id="empty-cart-message" class="text-center mt-5" style="display:none;">
          <p class="h4 text-muted">Your cart is currently empty.</p>
          <a href="collection.html" class="btn btn-dark mt-3">Continue Shopping</a>
        </div>
      </div>

      <div class="col-lg-4">
        <div class="cart-totals">
          <h5>Cart Totals</h5>
          <div class="d-flex"><span>Subtotal</span><span id="subtotal">$0.00</span></div>
          <div class="d-flex"><span>Shipping</span><span>$10.00</span></div>
          <div class="d-flex total-price"><span>Total</span><span id="cart-total">$0.00</span></div>
          <button class="btn checkout-btn mt-4">PROCEED TO CHECKOUT</button>
        </div>
      </div>
    </div>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="script/active.js"></script>
  <script src="script/cart.js"></script>

  <script>
    const CART_SHIPPING_COST = 10.00;

    function updateCartTotals() {
      const cart = getCart();
      let subtotal = 0;
      cart.forEach(item => subtotal += item.price * item.quantity);
      const total = subtotal + CART_SHIPPING_COST;
      document.getElementById('subtotal').textContent = `$${subtotal.toFixed(2)}`;
      document.getElementById('cart-total').textContent = `$${total.toFixed(2)}`;
    }

    function renderCartItems() {
      const cart = getCart();
      const cartBody = document.getElementById('cart-items-body');
      const emptyMsg = document.getElementById('empty-cart-message');
      cartBody.innerHTML = '';

      if (cart.length === 0) {
        emptyMsg.style.display = 'block';
        return;
      } else {
        emptyMsg.style.display = 'none';
      }

      cart.forEach(item => {
        const row = document.createElement('tr');
        const imagePath = item.imgSrc && item.imgSrc.startsWith('im/') ? item.imgSrc : `im/${item.imgSrc}`;
        const subtotal = item.price * item.quantity;

        row.innerHTML = `
          <td>
            <div class="d-flex align-items-center">
              <img src="${imagePath}" alt="${item.title}" class="cart-item-image">
              <div>
                <h6 class="mb-0">${item.title}</h6>
                <small class="text-muted">Size: ${item.size}</small>
              </div>
            </div>
          </td>
          <td>$${item.price.toFixed(2)}</td>
          <td>
            <div class="quantity-control">
              <button onclick="changeQuantity('${item.uniqueId}', -1)">-</button>
              <input type="number" value="${item.quantity}" min="1" readonly data-id="${item.uniqueId}">
              <button onclick="changeQuantity('${item.uniqueId}', 1)">+</button>
            </div>
          </td>
          <td id="subtotal-${item.uniqueId}">$${subtotal.toFixed(2)}</td>
          <td><button class="remove-btn" onclick="removeItem('${item.uniqueId}')">Remove</button></td>
        `;
        cartBody.appendChild(row);
      });
      updateCartTotals();
    }

    window.changeQuantity = function (uniqueId, delta) {
      let cart = getCart();
      const i = cart.findIndex(x => x.uniqueId === uniqueId);
      if (i > -1) {
        const newQty = cart[i].quantity + delta;
        if (newQty < 1) return removeItem(uniqueId);
        cart[i].quantity = newQty;
        saveCart(cart);
        document.querySelector(`input[data-id="${uniqueId}"]`).value = newQty;
        document.getElementById(`subtotal-${uniqueId}`).textContent = `$${(cart[i].price * newQty).toFixed(2)}`;
        updateCartTotals();
      }
    }

    window.removeItem = function (uniqueId) {
      let cart = getCart().filter(item => item.uniqueId !== uniqueId);
      saveCart(cart);
      renderCartItems();
    }

    document.addEventListener('DOMContentLoaded', renderCartItems);
  </script>
</body>
</html>
